{"version":3,"sources":["../../../../../../assets/raphael/component/optional/assets/raphael/component/optional/R.svg.js"],"names":["cheerio","require","trim","s","replace","compressSpaces","toNumberArray","a","split","i","length","parseFloat","parseNode","node","parent","current","tagName","addGroup","addPath","path","attribs","d","transform","data","type","position","cc","v2","rotation","scale","styles","style","name","value","fillColor","hexToColor","strokeColor","lineWidth","lineJoin","Graphics","LineJoin","toUpperCase","lineCap","LineCap","dashArray","dashOffset","children","ii","child","Svg","loadSvg","string","$","load","err","error","toString","svg","flipY","DomHandler","NodePrototype","ElementPrototype","prototype","_addDomElement","element","_tagStack","siblings","dom","previousSibling","next","_options","withStartIndices","startIndex","_parser","withDomLvl1","originElement","Object","create","k","prev","push","module","exports"],"mappings":"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","file":"R.svg.js","sourceRoot":"../../../../../../assets/raphael/component/optional","sourcesContent":["var cheerio = require('cheerio');\n\nfunction trim (s) { \n    return s.replace(/^\\s+|\\s+$/g, ''); \n}\n\nfunction compressSpaces (s) { \n    return s.replace(/[\\s\\r\\t\\n]+/gm,' '); \n}\n\nfunction toNumberArray (s) {\n    var a = trim(compressSpaces((s || '').replace(/,/g, ' '))).split(' ');\n    for (var i=0; i<a.length; i++) {\n        a[i] = parseFloat(a[i]);\n    }\n    return a;\n}\n\nfunction parseNode (node, parent) {\n    var current;\n\n    var tagName = node.tagName;\n    if (tagName === 'g') {\n        current = parent.addGroup();\n    }\n    else if (tagName === 'path') {\n        current = parent.addPath();\n        current.path(node.attribs.d);\n    }\n\n    if (current && node.attribs) {\n        // transform\n        var transform = node.attribs.transform;\n        if (transform) {\n            var data = trim(compressSpaces(transform)).replace(/\\)([a-zA-Z])/g, ') $1').replace(/\\)(\\s?,\\s?)/g,') ').split(/\\s(?=[a-z])/);\n            for (var i=0; i<data.length; i++) {\n                var type = trim(data[i].split('(')[0]);\n                var s = data[i].split('(')[1].replace(')','');\n                var a = toNumberArray(s);\n                \n                if (type === 'translate') {\n                    current.position = cc.v2(a[0], a[1]);\n                }\n                else if (type === 'rotate') {\n                    current.rotation = a[0];\n                }\n                else if (type === 'scale') {\n                    current.scale = cc.v2(a[0], a[1]);\n                }\n            }\n        }\n\n        var styles = node.attribs.style;\n        if (styles) {\n            styles = styles.split(';');\n            for (var i=0; i<styles.length; i++) {\n                if (trim(styles[i]) !== '') {\n                    var style = styles[i].split(':');\n                    var name = trim(style[0]);\n                    var value = trim(style[1]);\n\n                    if (name === 'fill') {\n                        current.fillColor = value === 'none' ? null : cc.hexToColor(value);\n                    }\n                    else if (name === 'stroke') {\n                        current.strokeColor = value === 'none' ? null : cc.hexToColor(value);\n                    }\n                    else if (name === 'stroke-width') {\n                        current.lineWidth = parseFloat(value);\n                    }\n                    else if (name === 'stroke-linejoin') {\n                        current.lineJoin = cc.Graphics.LineJoin[value.toUpperCase()];\n                    }\n                    else if (name === 'stroke-linecap') {\n                        current.lineCap = cc.Graphics.LineCap[value.toUpperCase()];\n                    }\n                    else if (name === 'stroke-dasharray') {\n                        current.dashArray = toNumberArray[value];\n                    }\n                    else if (name === 'stroke-dashoffset') {\n                        current.dashOffset = parseFloat(value);\n                    }\n                }\n            }\n        }\n    }\n\n    var children = node.children;\n    if (children) {\n        for (var i = 0, ii = children.length; i < ii; i++) {\n            var child = children[i];\n            parseNode(child, current || parent);\n        }\n    }\n}\n\nvar Svg = {\n    loadSvg: function (string) {\n        if (typeof string !== 'string') {\n            return;\n        }\n\n        var $;\n        try {\n            $ = cheerio.load(string);\n        }\n        catch (err) {\n            cc.error(err.toString());\n            return;\n        }\n\n        var svg = $('svg')[0];\n        parseNode(svg, this);\n\n        this.flipY = true;\n    },\n};\n\n\n// hack for jsb, not use __proto__\nvar DomHandler = require('DomHandler');\nvar NodePrototype = require(\"DomHandler/lib/node\");\nvar ElementPrototype = require(\"DomHandler/lib/element\");\n\nDomHandler.prototype._addDomElement = function(element){\n    var parent = this._tagStack[this._tagStack.length - 1];\n    var siblings = parent ? parent.children : this.dom;\n    var previousSibling = siblings[siblings.length - 1];\n\n    element.next = null;\n\n    if(this._options.withStartIndices){\n        element.startIndex = this._parser.startIndex;\n    }\n\n    if (this._options.withDomLvl1) {\n\n        var originElement = element;\n        element = Object.create(element.type === \"tag\" ? ElementPrototype : NodePrototype);\n        for (var k in originElement) {\n            element[k] = originElement[k];\n        }\n\n        // element.__proto__ = element.type === \"tag\" ? ElementPrototype : NodePrototype;\n    }\n\n    if(previousSibling){\n        element.prev = previousSibling;\n        previousSibling.next = element;\n    } else {\n        element.prev = null;\n    }\n\n    siblings.push(element);\n    element.parent = parent || null;\n};\n\nmodule.exports = Svg;\n"]}