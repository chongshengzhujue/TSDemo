{"version":3,"sources":["AudioManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"../../../../../assets/scripts/audio","sourcesContent":["//音效管理类 \n//2018.01.10 li.xiao\n\nconst {ccclass, property} = cc._decorator;\n\n@ccclass\nexport default class AudioManager {\n\n    static _instance:AudioManager = null; \n\n    defaultClickAudio:cc.url = null;\n\n    volume: number = 1;\n\n    isEffectActive:boolean = true;\n    isMusicActive:boolean = true;\n\n    audioEngine:any = null;\n\n    curMusicId:any = null;\n    curMusicPath:any = null;\n\n    static getInstance():AudioManager\n    {\n        if(AudioManager._instance == null)\n        {\n            AudioManager._instance = new AudioManager();\n        }\n        return AudioManager._instance;\n    }\n\n    constructor()\n    {\n        this.audioEngine = cc.audioEngine;\n        this.curMusicId = null;\n        this.curMusicPath = null;\n    }\n\n    // 用来初始化音效配置\n    initAudioSetting()\n    {\n\n    }\n\n    setVolume(volume:number)\n    {\n        this.volume = volume;\n    }\n\n    setDefaultClickAudio(audio:cc.url)\n    {\n        if (audio)\n        {\n            this.defaultClickAudio = audio;\n        }\n    }\n\n    playDefaultClickAudio()\n    {\n        if(this.defaultClickAudio && this.audioEngine && this.isEffectActive)\n        {\n            return this.audioEngine.play(this.defaultClickAudio , false, 0.5);\n        }\n    }\n\n    playEffect(audioClip:cc.url,isLoop:boolean)\n    {\n        if (this.audioEngine && audioClip && this.isEffectActive)\n        {\n            return this.audioEngine.play(audioClip , isLoop, 0.5);\n        }\n    }\n\n    playBtnEffect(target:cc.Node)\n    {\n        if(target)\n        {\n            var audioComp = target.getComponent(\"EffectAudioClip\");\n            if (audioComp && audioComp.audio )\n            {\n                this.playEffect(audioComp.audio,false);\n            }\n            else\n            {\n                this.playDefaultClickAudio();\n            }\n        }\n    }\n\n    playMusic(audioClip:cc.url,isLoop:boolean,callback:any)\n    {\n        if (this.audioEngine && audioClip && audioClip !== this.curMusicPath )\n        {\n            if(this.curMusicId)\n            {\n                this.audioEngine.stop(this.curMusicId);\n                this.audioEngine.uncache(this.curMusicPath);\n                this.curMusicId = null;\n            }\n            if (this.isMusicActive)\n            {\n                this.curMusicId = this.audioEngine.play(audioClip , isLoop, this.volume);\n                return this.curMusicId;\n            }   \n        }\n    }\n\n    onEffectSwith(isActive:boolean)\n    {\n        if (this.isEffectActive == isActive)\n        {\n            ;\n        }\n        else\n        {\n            this.isEffectActive = isActive\n        }\n    }\n\n    onMusicSwith(isActive:boolean)\n    {\n        if (this.isMusicActive == isActive)\n        {\n            ;\n        }\n        else\n        {\n            this.isMusicActive = isActive\n            if(this.isMusicActive)\n            {\n                this.playMusic(this.curMusicPath,true,this.volume);\n            }\n            else\n            {\n                this.stop(this.curMusicId);\n            }\n        }\n    }\n\n    stop(audioId:any)\n    {\n        if (audioId && this.audioEngine)\n        {\n            this.audioEngine.stop(audioId);\n        }\n    }\n\n    stopAll()\n    {\n        if (this.audioEngine)\n        {\n            this.audioEngine.stopAll();\n        }\n    }\n\n    // update (dt) {},\n}\n"]}