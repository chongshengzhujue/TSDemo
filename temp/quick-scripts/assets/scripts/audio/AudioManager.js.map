{"version":3,"sources":["AudioManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\audio","sourcesContent":["//音效管理类 \r\n//2018.01.10 li.xiao\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class AudioManager {\r\n\r\n    static _instance:AudioManager = null; \r\n\r\n    defaultClickAudio:cc.url = null;\r\n\r\n    volume: number = 1;\r\n\r\n    isEffectActive:boolean = true;\r\n    isMusicActive:boolean = true;\r\n\r\n    audioEngine:any = null;\r\n\r\n    curMusicId:any = null;\r\n    curMusicPath:any = null;\r\n\r\n    static getInstance():AudioManager\r\n    {\r\n        if(AudioManager._instance == null)\r\n        {\r\n            AudioManager._instance = new AudioManager();\r\n        }\r\n        return AudioManager._instance;\r\n    }\r\n\r\n    constructor()\r\n    {\r\n        this.audioEngine = cc.audioEngine;\r\n        this.curMusicId = null;\r\n        this.curMusicPath = null;\r\n    }\r\n\r\n    // 用来初始化音效配置\r\n    initAudioSetting()\r\n    {\r\n\r\n    }\r\n\r\n    setVolume(volume:number)\r\n    {\r\n        this.volume = volume;\r\n    }\r\n\r\n    setDefaultClickAudio(audio:cc.url)\r\n    {\r\n        if (audio)\r\n        {\r\n            this.defaultClickAudio = audio;\r\n        }\r\n    }\r\n\r\n    playDefaultClickAudio()\r\n    {\r\n        if(this.defaultClickAudio && this.audioEngine && this.isEffectActive)\r\n        {\r\n            return this.audioEngine.play(this.defaultClickAudio , false, 0.5);\r\n        }\r\n    }\r\n\r\n    playEffect(audioClip:cc.url,isLoop:boolean)\r\n    {\r\n        if (this.audioEngine && audioClip && this.isEffectActive)\r\n        {\r\n            return this.audioEngine.play(audioClip , isLoop, 0.5);\r\n        }\r\n    }\r\n\r\n    playBtnEffect(target:cc.Node)\r\n    {\r\n        if(target)\r\n        {\r\n            var audioComp = target.getComponent(\"EffectAudioClip\");\r\n            if (audioComp && audioComp.audio )\r\n            {\r\n                this.playEffect(audioComp.audio,false);\r\n            }\r\n            else\r\n            {\r\n                this.playDefaultClickAudio();\r\n            }\r\n        }\r\n    }\r\n\r\n    playMusic(audioClip:cc.url,isLoop:boolean,callback:any)\r\n    {\r\n        if (this.audioEngine && audioClip && audioClip !== this.curMusicPath )\r\n        {\r\n            if(this.curMusicId)\r\n            {\r\n                this.audioEngine.stop(this.curMusicId);\r\n                this.audioEngine.uncache(this.curMusicPath);\r\n                this.curMusicId = null;\r\n            }\r\n            if (this.isMusicActive)\r\n            {\r\n                this.curMusicId = this.audioEngine.play(audioClip , isLoop, this.volume);\r\n                return this.curMusicId;\r\n            }   \r\n        }\r\n    }\r\n\r\n    onEffectSwith(isActive:boolean)\r\n    {\r\n        if (this.isEffectActive == isActive)\r\n        {\r\n            ;\r\n        }\r\n        else\r\n        {\r\n            this.isEffectActive = isActive\r\n        }\r\n    }\r\n\r\n    onMusicSwith(isActive:boolean)\r\n    {\r\n        if (this.isMusicActive == isActive)\r\n        {\r\n            ;\r\n        }\r\n        else\r\n        {\r\n            this.isMusicActive = isActive\r\n            if(this.isMusicActive)\r\n            {\r\n                this.playMusic(this.curMusicPath,true,this.volume);\r\n            }\r\n            else\r\n            {\r\n                this.stop(this.curMusicId);\r\n            }\r\n        }\r\n    }\r\n\r\n    stop(audioId:any)\r\n    {\r\n        if (audioId && this.audioEngine)\r\n        {\r\n            this.audioEngine.stop(audioId);\r\n        }\r\n    }\r\n\r\n    stopAll()\r\n    {\r\n        if (this.audioEngine)\r\n        {\r\n            this.audioEngine.stopAll();\r\n        }\r\n    }\r\n\r\n    // update (dt) {},\r\n}\r\n"]}