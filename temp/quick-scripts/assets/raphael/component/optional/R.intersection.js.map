{"version":3,"sources":["R.intersection.js"],"names":["bezlen","require","findDotAtSegment","findDotsAtSegment","mmax","Math","max","mmin","min","abs","math","curveDim","p1x","p1y","c1x","c1y","c2x","c2y","p2x","p2y","a","b","c","t1","sqrt","t2","y","x","dot","push","apply","isPointInsideBBox","bbox","x2","y2","isBBoxIntersect","bbox1","bbox2","i","bezierBBox","Array","isArray","width","height","intersect","x1","y1","x3","y3","x4","y4","nx","ny","denominator","px","py","px2","toFixed","py2","base3","t","p1","p2","p3","p4","interHelper","bez1","bez2","justCheck","l1","l2","n1","n2","dots1","dots2","xy","res","p","concat","j","di","di1","dj","dj1","ci","cj","is","module","exports"],"mappings":"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","file":"R.intersection.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\raphael\\component\\optional","sourcesContent":["'use strict';\r\n\r\nvar bezlen = require('../../utils/R.length').bezlen;\r\nvar findDotAtSegment = require('../../utils/R.find').findDotAtSegment;\r\nvar findDotsAtSegment = require('../../utils/R.find').findDotsAtSegment;\r\n\r\nvar mmax = Math.max;\r\nvar mmin = Math.min;\r\nvar abs  = Math.abs;\r\nvar math = Math;\r\n\r\nfunction curveDim (p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y) {\r\n    var a = (c2x - 2 * c1x + p1x) - (p2x - 2 * c2x + c1x),\r\n        b = 2 * (c1x - p1x) - 2 * (c2x - c1x),\r\n        c = p1x - c1x,\r\n        t1 = (-b + math.sqrt(b * b - 4 * a * c)) / 2 / a,\r\n        t2 = (-b - math.sqrt(b * b - 4 * a * c)) / 2 / a,\r\n        y = [p1y, p2y],\r\n        x = [p1x, p2x],\r\n        dot;\r\n    abs(t1) > '1e12' && (t1 = .5);\r\n    abs(t2) > '1e12' && (t2 = .5);\r\n    if (t1 > 0 && t1 < 1) {\r\n        dot = findDotAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t1);\r\n        x.push(dot.x);\r\n        y.push(dot.y);\r\n    }\r\n    if (t2 > 0 && t2 < 1) {\r\n        dot = findDotAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t2);\r\n        x.push(dot.x);\r\n        y.push(dot.y);\r\n    }\r\n    a = (c2y - 2 * c1y + p1y) - (p2y - 2 * c2y + c1y);\r\n    b = 2 * (c1y - p1y) - 2 * (c2y - c1y);\r\n    c = p1y - c1y;\r\n    t1 = (-b + math.sqrt(b * b - 4 * a * c)) / 2 / a;\r\n    t2 = (-b - math.sqrt(b * b - 4 * a * c)) / 2 / a;\r\n    abs(t1) > '1e12' && (t1 = .5);\r\n    abs(t2) > '1e12' && (t2 = .5);\r\n    if (t1 > 0 && t1 < 1) {\r\n        dot = findDotAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t1);\r\n        x.push(dot.x);\r\n        y.push(dot.y);\r\n    }\r\n    if (t2 > 0 && t2 < 1) {\r\n        dot = findDotAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t2);\r\n        x.push(dot.x);\r\n        y.push(dot.y);\r\n    }\r\n    return {\r\n        min: {x: mmin[apply](0, x), y: mmin[apply](0, y)},\r\n        max: {x: mmax[apply](0, x), y: mmax[apply](0, y)}\r\n    };\r\n}\r\n\r\nfunction isPointInsideBBox (bbox, x, y) {\r\n    return x >= bbox.x && x <= bbox.x2 && y >= bbox.y && y <= bbox.y2;\r\n}\r\n\r\nfunction isBBoxIntersect (bbox1, bbox2) {\r\n    var i = isPointInsideBBox;\r\n    return i(bbox2, bbox1.x, bbox1.y)\r\n        || i(bbox2, bbox1.x2, bbox1.y)\r\n        || i(bbox2, bbox1.x, bbox1.y2)\r\n        || i(bbox2, bbox1.x2, bbox1.y2)\r\n        || i(bbox1, bbox2.x, bbox2.y)\r\n        || i(bbox1, bbox2.x2, bbox2.y)\r\n        || i(bbox1, bbox2.x, bbox2.y2)\r\n        || i(bbox1, bbox2.x2, bbox2.y2)\r\n        || (bbox1.x < bbox2.x2 && bbox1.x > bbox2.x || bbox2.x < bbox1.x2 && bbox2.x > bbox1.x)\r\n        && (bbox1.y < bbox2.y2 && bbox1.y > bbox2.y || bbox2.y < bbox1.y2 && bbox2.y > bbox1.y);\r\n};\r\n\r\nfunction bezierBBox (p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y) {\r\n    if (!Array.isArray(p1x)) {\r\n        p1x = [p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y];\r\n    }\r\n    var bbox = curveDim.apply(null, p1x);\r\n    return {\r\n        x: bbox.min.x,\r\n        y: bbox.min.y,\r\n        x2: bbox.max.x,\r\n        y2: bbox.max.y,\r\n        width: bbox.max.x - bbox.min.x,\r\n        height: bbox.max.y - bbox.min.y\r\n    };\r\n}\r\n\r\nfunction intersect(x1, y1, x2, y2, x3, y3, x4, y4) {\r\n    if (\r\n        mmax(x1, x2) < mmin(x3, x4) ||\r\n        mmin(x1, x2) > mmax(x3, x4) ||\r\n        mmax(y1, y2) < mmin(y3, y4) ||\r\n        mmin(y1, y2) > mmax(y3, y4)\r\n    ) {\r\n        return;\r\n    }\r\n    var nx = (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\r\n        ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\r\n        denominator = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\r\n\r\n    if (!denominator) {\r\n        return;\r\n    }\r\n    var px = nx / denominator,\r\n        py = ny / denominator,\r\n        px2 = +px.toFixed(2),\r\n        py2 = +py.toFixed(2);\r\n    if (\r\n        px2 < +mmin(x1, x2).toFixed(2) ||\r\n        px2 > +mmax(x1, x2).toFixed(2) ||\r\n        px2 < +mmin(x3, x4).toFixed(2) ||\r\n        px2 > +mmax(x3, x4).toFixed(2) ||\r\n        py2 < +mmin(y1, y2).toFixed(2) ||\r\n        py2 > +mmax(y1, y2).toFixed(2) ||\r\n        py2 < +mmin(y3, y4).toFixed(2) ||\r\n        py2 > +mmax(y3, y4).toFixed(2)\r\n    ) {\r\n        return;\r\n    }\r\n    return {x: px, y: py};\r\n}\r\n\r\nfunction base3(t, p1, p2, p3, p4) {\r\n    var t1 = -3 * p1 + 9 * p2 - 9 * p3 + 3 * p4,\r\n        t2 = t * t1 + 6 * p1 - 12 * p2 + 6 * p3;\r\n    return t * t2 - 3 * p1 + 3 * p2;\r\n}\r\nfunction interHelper(bez1, bez2, justCheck) {\r\n    var bbox1 = bezierBBox(bez1),\r\n        bbox2 = bezierBBox(bez2);\r\n    if (!isBBoxIntersect(bbox1, bbox2)) {\r\n        return justCheck ? false : [];\r\n    }\r\n\r\n    var l1 = bezlen.apply(0, bez1),\r\n        l2 = bezlen.apply(0, bez2),\r\n        n1 = mmax(~~(l1 / 5), 1),\r\n        n2 = mmax(~~(l2 / 5), 1),\r\n        dots1 = [],\r\n        dots2 = [],\r\n        xy = {},\r\n        res = [];\r\n    for (var i = 0; i < n1 + 1; i++) {\r\n        var p = findDotsAtSegment.apply(this, bez1.concat(i / n1));\r\n        dots1.push({x: p.x, y: p.y, t: i / n1});\r\n    }\r\n    for (i = 0; i < n2 + 1; i++) {\r\n        p = findDotsAtSegment.apply(this, bez2.concat(i / n2));\r\n        dots2.push({x: p.x, y: p.y, t: i / n2});\r\n    }\r\n    for (i = 0; i < n1; i++) {\r\n        for (var j = 0; j < n2; j++) {\r\n            var di = dots1[i],\r\n                di1 = dots1[i + 1],\r\n                dj = dots2[j],\r\n                dj1 = dots2[j + 1],\r\n                ci = abs(di1.x - di.x) < .001 ? 'y' : 'x',\r\n                cj = abs(dj1.x - dj.x) < .001 ? 'y' : 'x',\r\n                is = intersect(di.x, di.y, di1.x, di1.y, dj.x, dj.y, dj1.x, dj1.y);\r\n            if (is) {\r\n                if (xy[is.x.toFixed(4)] == is.y.toFixed(4)) {\r\n                    continue;\r\n                }\r\n                xy[is.x.toFixed(4)] = is.y.toFixed(4);\r\n                var t1 = di.t + abs((is[ci] - di[ci]) / (di1[ci] - di[ci])) * (di1.t - di.t),\r\n                    t2 = dj.t + abs((is[cj] - dj[cj]) / (dj1[cj] - dj[cj])) * (dj1.t - dj.t);\r\n                if (t1 >= 0 && t1 <= 1.001 && t2 >= 0 && t2 <= 1.001) {\r\n                    if (justCheck) {\r\n                        return true;\r\n                    } else {\r\n                        res.push({\r\n                            x: is.x,\r\n                            y: is.y,\r\n                            t1: mmin(t1, 1),\r\n                            t2: mmin(t2, 1)\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return justCheck ? false : res;\r\n}\r\n\r\nmodule.exports = {\r\n    intersect: interHelper\r\n};\r\n"]}